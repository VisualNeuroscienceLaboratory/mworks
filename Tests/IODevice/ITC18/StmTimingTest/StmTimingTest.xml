<?xml version="1.0"?>
<monkeyml version="1.0">
    <io_devices>
        <iodevice tag="ITC" priority="" type="ITC18" id="">
            <iochannel variable="luminence" capability="ITC18_ADC_INPUT0" data_type="analog" direction="input" synchrony="hardware_timed_synchronous" range_min="-10" range_max="10" resolution="16" update_interval="3ms" data_interval="1ms" tag="Eye_H_channel" TTL_trigger_port="0" pre_trigger_interval="5ms" post_trigger_interval="5ms"/>
            <iochannel variable="vertical_refresh" capability="ITC18_TTL_INPUT0" data_type="edge_low_to_high" direction="input" synchrony="hardware_timed_synchronous" range_min="0" range_max="5" resolution="1" update_interval="3ms" data_interval="0.05ms" tag="Vertical_Refresh_channel"/>
        </iodevice>
    </io_devices>
    <variables>
        <variable tag="sync" full_name="luminence" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"/>
        <variable tag="luminence" full_name="luminence" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"/>
        <variable tag="stim_index" full_name="number_of_stm_shown" default_value="0" scope="LOCAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"/>
        <variable tag="stm_duration" full_name="stm_duration" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"/>
        <variable tag="vertical_refresh" full_name="fullname9" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"/>
        <variable tag="display_update" full_name="fullname9" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"/>
    </variables>
    <sounds/>
    <stimuli>
        <stimulus tag="background" full_name="background" type="blank_screen" color="0, 0, 0"/>
        <stimulus tag="stm1" full_name="stm1" type="blank_screen" color="1, 1, 1"/>
    </stimuli>
    <experiment tag="stimTimingTest" full_name="stimTimingtest" description="">
        <protocol tag="protocol" full_name="protocol" interruptable="YES" selection="sequential_ascending" nsamples="1" sampling_method="cycles" description="" interruptible="YES">
            <block tag="block" full_name="block" interruptable="YES" selection="sequential_ascending" nsamples="100" sampling_method="cycles" description="" interruptible="YES">
                <action tag="syncOn" full_name="sync" type="assignment" variable="sync" value="1"/>
                <action tag="Start ITC" type="start_device_IO" device="ITC"/>
                <trial tag="trial" full_name="trial" interruptable="YES" selection="random_without_replacement" nsamples="1" sampling_method="cycles" description="" interruptible="YES">
                    <range_replicator tag="Range Replicator_1" from="0" to="4" step="1" variable="stim_index">
                        <task_system tag="TSS" full_name="fullname21" interruptable="YES" description="" interruptible="YES">
                            <task_system_state tag="background on" full_name="background on" interruptable="YES" description="" interruptible="YES">
                                <action tag="QueueBackground" type="queue_stimulus" stimulus="background"/>
                                <action tag="increment display_update" full_name="increment display_update" type="assignment" variable="display_update" value="display_update+1"/>
                                <action tag="display refresh" full_name="display refresh" type="update_stimulus_display"/>
                                <action tag="start stm_timer" full_name="start stm_timer" type="start_timer" timer="stm_timer" duration="1000ms" timebase=""/>
                                <transition tag="go to stm on" full_name="go to stm on" target="stm on" type="timer_expired" timer="stm_timer"/>
                            </task_system_state>
                            <task_system_state tag="stm on" full_name="stm on" interruptable="YES" description="" interruptible="YES">
                                <action tag="QueueStim" type="queue_stimulus" stimulus="stm1"/>
                                <action tag="increment display_update" full_name="increment display_update" type="assignment" variable="display_update" value="display_update+1"/>
                                <action tag="display refresh" full_name="display refresh" type="update_stimulus_display"/>
                                <action tag="record stm_duration" full_name="record stm_duration" type="assignment" variable="stm_duration" value="stim_index*100000 + 100000"/>
                                <action tag="start stm_timer" full_name="start stm_timer" type="start_timer" timer="stm_timer" duration="stm_duration" timebase=""/>
                                <transition tag="go to trial end" full_name="go to trial end" target="trial_end" type="timer_expired" timer="stm_timer"/>
                            </task_system_state>
                            <task_system_state tag="trial_end" full_name="trial end" interruptable="YES" description="" interruptible="YES">
                                <action tag="report message" full_name="report message" type="report" message="**************TRIAL ENDING**************"/>
                                <transition type="yield" tag="yield" full_name="yield"/>
                            </task_system_state>
                        </task_system>
                    </range_replicator>
                </trial>
                <action tag="Wait" type="wait" duration="250 ms"/>
                <action tag="Stop ITC" type="stop_device_IO" device="ITC"/>
                <action tag="syncOff" full_name="sync" type="assignment" variable="sync" value="0"/>
            </block>
        </protocol>
    </experiment>
</monkeyml>